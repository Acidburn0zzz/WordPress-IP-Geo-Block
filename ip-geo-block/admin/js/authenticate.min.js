/*!
 * Project: WP-ZEP - Zero-day exploit Prevention for wp-admin
 * Copyright (c) 2015-2016 tokkonopapa (tokkonopapa@yahoo.com)
 * This software is released under the MIT License.
 */
var IP_GEO_BLOCK_ZEP={auth:"ip-geo-block-auth-nonce",nonce:IP_GEO_BLOCK_AUTH.nonce||"",redirect:function(d){-1!==location.href.indexOf(d)&&(this.nonce&&(d+=(0<=d.indexOf("?")?"&":"?")+this.auth+"="+this.nonce),window.location.href=d)}};(function(d,p){function q(a){return a?a.toString().replace(/[&<>"']/g,function(a){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[a]}):""}function f(a){a=decodeURIComponent(a?a.toString():"");a=a.match(/^(?:([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);return{scheme:a[1]||"",relative:a[2]||"",authority:a[3]||"",path:a[4]||"",query:a[5]||"",fragment:a[6]||""}}function m(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16)})}function k(a,c){"object"!==typeof a&&(a=f(a||location.href));for(var b=a.query?a.query.split("&"):[],e=b.length;0<e--;)if(0===b[e].indexOf(IP_GEO_BLOCK_ZEP.auth)){b.splice(e,1);break}b.push(IP_GEO_BLOCK_ZEP.auth+"="+m(c));a.query=b.join("&");return(a.scheme?a.scheme+":":"")+(a.relative+a.path)+(a.query?"?"+a.query:"")+(a.fragment?"#"+a.fragment:"")}function l(a){a=f(a?a.toString().toLowerCase():location.pathname);var c,b=a,e=[];"object"!==typeof b&&(b=f(b));b=b.path;if("/"!==b.charAt(0))var d=window.location.pathname,b=d.substring(0,d.lastIndexOf("/")+1)+b;b=b.split("/");""===b[b.length-1]&&(b.pop(),b[b.length-1]+="/");for(c in b)b.hasOwnProperty(c)&&"."!==b[c]&&(".."===b[c]?0<e.length&&e.pop():(1>e.length||""!==b[c])&&e.push(b[c]));c=e.join("/").replace(/\/\//g,"/");if(/https?/.test(a.scheme)||!a.scheme){if(a.authority&&a.authority!==location.host.toLowerCase())return-1;if((a.scheme||a.path||a.query)&&r.test(c))return 1}return 0}function n(a,c,b){var e=c.split(/\s+/);a.each(function(){for(var a=0;a<e.length;++a){var c=d.trim(e[a]).match(/[^\.]+/i)[0],g=d(this),f=c,c=b,g=d._data(g[0]).events[f],f=c?g.splice(g.delegateCount-1,1)[0]:g.pop();g.splice(c?0:g.delegateCount||0,0,f)}})}var r=new RegExp("^(?:"+IP_GEO_BLOCK_AUTH.root+IP_GEO_BLOCK_AUTH.admin+"|"+IP_GEO_BLOCK_AUTH.root+IP_GEO_BLOCK_AUTH.plugins+"|"+IP_GEO_BLOCK_AUTH.root+IP_GEO_BLOCK_AUTH.themes+")(?:.*.php|.*/)?$"),h={};h[IP_GEO_BLOCK_AUTH.root+IP_GEO_BLOCK_AUTH.admin+"theme-install.php"]=function(a){for(var c=a.length;0<c--;)if(0===a[c].indexOf("request%5Bbrowse%5D=ip-geo-block-auth")){a[c]="request%5Bbrowse%5D=featured";break}return a};d(p).ajaxSend(function(a,c,b){if((a=IP_GEO_BLOCK_ZEP.nonce)&&1===l(b.url))if("undefined"!==typeof window.FormData&&b.data instanceof FormData)b.data.append(IP_GEO_BLOCK_ZEP.auth,a);else if(c=f(b.url),"undefined"===typeof b.data||c.query)b.url=k(c,a);else{c=b.data?b.data.split("&"):[];var e;e=location.pathname;(e=h.hasOwnProperty(e)?h[e]:null)&&(c=e(c));c.push(IP_GEO_BLOCK_ZEP.auth+"="+m(a));b.data=c.join("&")}});"undefined"===typeof d.fn.onFirst&&(d.fn.onFirst=function(a,c){var b,e=d(this),f="string"===typeof c;d.fn.on.apply(e,arguments);if("object"===typeof a)for(b in a)a.hasOwnProperty(b)&&n(e,b,f);else"string"===typeof a&&n(e,a,f);return e});d(function(){var a=IP_GEO_BLOCK_ZEP.nonce;if(a){var c=d("body");c.find("img").each(function(b){b=d(this).attr("src");1===l(b)&&d(this).attr("src",k(b,a))});c.onFirst("click","a",function(b){b=d(this);var c=b.attr("href"),f=b.attr("rel"),h="undefined"!==typeof c?l(c):0;if(1===h)b.attr("href",k(c,!f||0>f.indexOf("nofollow")?a:"nofollow"));else if(-1===h)return b=window.open(),b.document.write('<meta name="referrer" content="never" /><meta name="referrer" content="no-referrer" /><meta http-equiv="refresh" content="0; url='+q(this.href)+'" />'),b.document.close(),!1});c.onFirst("submit","form",function(b){b=d(this);var c=b.attr("action");1===l(c)&&b.attr("action",k(c,a))})}})})(jQuery,document);